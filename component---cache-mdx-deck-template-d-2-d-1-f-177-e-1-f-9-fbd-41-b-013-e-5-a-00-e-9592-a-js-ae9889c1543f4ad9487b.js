(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{177:function(e,n,t){"use strict";t.r(n);var a=t(0),o=t.n(a),r=t(186),c=(t(28),t(20),t(11),t(46),t(21),t(194)),m=t(258),l=(t(193),t(203)),s=t(428),p=t.n(s),i=t(429),u=t.n(i),d=t(430),g=t.n(d),E=t(431),f=t.n(E);function T(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}var D=Object.assign({},l.dark,{codeSurfer:Object.assign({},p.a,{showNumbers:!0})}),M=(new Date("2018-11-02T00:00:00.000Z"),[function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(c.MDXTag,{name:"h1",components:n},"About ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"h1"},"loc")," pragma"),o.a.createElement(c.MDXTag,{name:"h2",components:n},"TSUYUSATO Kitsune (@MakeNowJust)"))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(c.MDXTag,{name:"h2",components:n},"About Me"),o.a.createElement(c.MDXTag,{name:"ul",components:n},o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"TSUYUSATO Kitsune"),o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"GitHub: @MakeNowJust"),o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"Twitter: @make_now_just"),o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"Frontend Engineer at Space Pirates LLC.")))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(c.MDXTag,{name:"h2",components:n},"No.4 Crystal Contributor"),o.a.createElement("img",{src:u.a}))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(c.MDXTag,{name:"h2",components:n},o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"loc")," pragma?"),o.a.createElement(c.MDXTag,{name:"ul",components:n},o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"One of the hidden (undocumented) features of Crystal"),o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"It can update location on parsing explicitly.")),o.a.createElement("img",{src:g.a}))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(c.MDXTag,{name:"h2",components:n},"Example: ECR"))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(c.MDXTag,{name:"h2",components:n},"How ECR works"),o.a.createElement(c.MDXTag,{name:"ol",components:n},o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ol"},"Macro ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"ECR.def_to_s")," calls ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"run")," macro with ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"ecr/process")," and given ECR file."),o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ol"},"Program ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"ecr/process")," prints Crystal source code generated from given ECR file."),o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ol"},"Then, this generated source code is embeded as a ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"ECR.def_to_s")," result.")))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(m.CodeSurfer,{title:"ecr-sample.cr",code:t(432).default.trim(),lang:"ruby"}))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(m.CodeSurfer,{title:"ecr-sample.ecr",code:t(433).default.trim(),lang:"html",steps:[{},{lines:[6],notes:'"tilte" is misspelled...'}]}))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(m.CodeSurfer,{title:"Execute ecr-sample.cr",code:t(434).default.trim(),lang:"text",steps:[{},{lines:[31,32,33,34],notes:"show correct location instead of generated code location"}]}))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(c.MDXTag,{name:"h2",components:n},"How does ECR tell original source code location to compiler?"))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(c.MDXTag,{name:"h2",components:n},"Run ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"ecr/process")," at hand."),o.a.createElement(c.MDXTag,{name:"pre",components:n},o.a.createElement(c.MDXTag,{name:"code",components:n,parentName:"pre",props:{metaString:null}},"$ echo 'require \"ecr/process\"' |\n    crystal run --stdin-filename process.cr -- ecr-sample.ecr ___io___\n")),o.a.createElement(c.MDXTag,{name:"p",components:n},"(MEMO: the second command-line argument of ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"ecr/process")," means a variable name to write output.)"))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(m.CodeSurfer,{title:"Result of ecr-sample.ecr",code:t(435).default.trim(),lang:"ruby",steps:[{},{lines:[1,3,5],notes:"These lines are corresponding to literal texts simply."},{lines:[2,4],notes:"These line are corresponding to <%= ... %>, however, what is #<loc:...>?"}]}))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(c.MDXTag,{name:"h2",components:n},o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"loc")," pragma syntax"),o.a.createElement(c.MDXTag,{name:"ul",components:n},o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},'#<loc:"filename",line_number,column_number>')),o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"Override parsing location as given values."),o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"It looks like line comment, but it is not a comment."),o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"So, source code after ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"loc")," pragma is also parsed.")))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(c.MDXTag,{name:"h2",components:n},o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"loc")," pragma syntax (",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"push")," and ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"pop"),")"),o.a.createElement(c.MDXTag,{name:"ul",components:n},o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"#<loc:push>")," and ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"#<loc:pop>")),o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"#<loc:push>")," saves current location."),o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"#<loc:pop>")," restores the location saved by previous ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"#<loc:push>"),".")),o.a.createElement(c.MDXTag,{name:"p",components:n},"It is useful to distinguish between macro generated code and original code."))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(c.MDXTag,{name:"h2",components:n},"Example: fix macro argument location"))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(m.CodeSurfer,{title:"new.cr",code:t(436).default.trim(),lang:"ruby",steps:[{},{lines:[5],notes:"BadType is not defined of course."}]}))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(m.CodeSurfer,{title:"Execute new.cr",code:t(437).default.trim(),lang:"text",steps:[{},{lines:[11,12,13],notes:"Show macro generated code. But is it useful?"}]}))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(m.CodeSurfer,{title:"new.cr with loc pragma",code:t(438).default.trim(),lang:"ruby",steps:[{},{lines:[2],notes:"Build loc pragma by hand."}]}))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(m.CodeSurfer,{title:"Execute new.cr with loc pragma",code:t(439).default.trim(),lang:"text",steps:[{notes:"Then, it shows really clear error message."}]}))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(c.MDXTag,{name:"h2",components:n},"If all expanded macro argument outputs its ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"loc")," pragma..."),o.a.createElement(c.MDXTag,{name:"ul",components:n},o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"I think it is more natural and useful."),o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"However ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"loc")," pragma is just text, so it causes some issues. e.g."),o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"When macro expansion appears in ",o.a.createElement(c.MDXTag,{name:"strong",components:n,parentName:"li"},"doc comment"),"..."),o.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"When macro expansion appears in ",o.a.createElement(c.MDXTag,{name:"strong",components:n,parentName:"li"},"string literal"),"...")),o.a.createElement(c.MDXTag,{name:"p",components:n},"So, currently the compiler does not outputs ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"loc")," pragma for macro argument."))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(c.MDXTag,{name:"h2",components:n},"But now,"),o.a.createElement(c.MDXTag,{name:"p",components:n},"I created a new Pull Request with new approach."))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(c.MDXTag,{name:"h2",components:n},o.a.createElement(c.MDXTag,{name:"a",components:n,parentName:"h2",props:{href:"https://github.com/crystal-lang/crystal/pull/7008"}},"crystal-lang/crystal#7008")),o.a.createElement("img",{src:f.a}),o.a.createElement(c.MDXTag,{name:"p",components:n},"It does not outputs ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"loc")," pragma directly, but it keeps ",o.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"loc")," pragmas as internal data."),o.a.createElement(c.MDXTag,{name:"p",components:n},"Unfortunately it is not merged..."))},function(e){var n=e.components;T(e,["components"]);return o.a.createElement(c.MDXTag,{name:"wrapper",components:n},o.a.createElement(c.MDXTag,{name:"h1",components:n},"Stay tuned ❤️"))}]);t.d(n,"query",function(){return X});n.default=function(e){var n=e.data;return o.a.createElement(r.a,{data:n,slides:M,theme:D})};var X="2617449398"},186:function(e,n,t){"use strict";t(28),t(20),t(11);var a=t(191),o=t(15),r=t.n(o),c=t(0),m=t.n(c),l=t(193),s=t(200);t(196);Object(s.setConfig)({ignoreSFC:!0,pureRender:!0});var p=a.updaters.previous,i=a.updaters.next,u=a.updaters.decrementIndex,d=a.updaters.incrementIndex,g=a.updaters.decrementStep,E=a.updaters.incrementStep,f=a.updaters.toggleMode,T=a.constants.keys,D=m.a.memo(function(e){var n=e.data,t=e.slides,o=e.theme,r=m.a.createRef(),s=m.a.createRef();Object(c.useEffect)(function(){s.current.focus()});var D=n.site.siteMetadata.title,M=n.file.fields.frontmatter.title+" - "+D;return m.a.createElement(m.a.Fragment,null,m.a.createElement(l.Helmet,null,m.a.createElement("title",null,M),m.a.createElement("meta",{name:"viewport",content:""})),m.a.createElement("div",{ref:s,role:"presentation",tabIndex:"-1",onKeyDown:function(e){if(document.activeElement===s.current&&!e.metaKey&&!e.ctrlKey){var n=r.current,t=e.altKey&&!e.shiftKey,a=e.shiftKey&&!e.altKey;if(t)switch(e.keyCode){case T.p:n.update(f("presenter"));break;case T.o:n.update(f("overview"));break;case T.g:n.update(f("grid"))}else if(a)switch(e.keyCode){case T.right:case T.pageDown:e.preventDefault(),n.update(d);break;case T.left:case T.pageUp:e.preventDefault(),n.update(u)}else if(!t&&!a)switch(e.keyCode){case T.right:case T.pageDown:case T.space:e.preventDefault(),n.update(i);break;case T.left:case T.pageUp:e.preventDefault(),n.update(p);break;case T.up:n.update(g);break;case T.down:n.update(E)}}}},m.a.createElement(a.SlideDeck,{ref:r,slides:t,theme:o})))});D.propTypes={data:r.a.object.isRequired,slides:r.a.array.isRequired,theme:r.a.object.isRequired},n.a=D},428:function(e,n){e.exports={plain:{color:"#d6deeb",backgroundColor:"#011627"},styles:[{types:["changed"],style:{color:"rgb(162, 191, 252)",fontStyle:"italic"}},{types:["deleted"],style:{color:"rgba(239, 83, 80, 0.56)",fontStyle:"italic"}},{types:["inserted","attr-name"],style:{color:"rgb(173, 219, 103)",fontStyle:"italic"}},{types:["comment"],style:{color:"rgb(99, 119, 119)",fontStyle:"italic"}},{types:["string","url"],style:{color:"rgb(173, 219, 103)"}},{types:["variable"],style:{color:"rgb(214, 222, 235)"}},{types:["number"],style:{color:"rgb(247, 140, 108)"}},{types:["builtin","char","constant","function"],style:{color:"rgb(130, 170, 255)"}},{types:["punctuation"],style:{color:"rgb(199, 146, 234)"}},{types:["selector","doctype"],style:{color:"rgb(199, 146, 234)",fontStyle:"italic"}},{types:["class-name"],style:{color:"rgb(255, 203, 139)"}},{types:["tag","operator","keyword"],style:{color:"rgb(127, 219, 202)"}},{types:["boolean"],style:{color:"rgb(255, 88, 116)"}},{types:["property"],style:{color:"rgb(128, 203, 196)"}},{types:["namespace"],style:{color:"rgb(178, 204, 214)"}}]}},429:function(e,n,t){e.exports=t.p+"static/contributors-6b0cbdfa111bd0ea291cca734dc55074.png"},430:function(e,n,t){e.exports=t.p+"static/search-loc-pragma-be7fed0101a863fe3b9b187b38bb31c7.png"},431:function(e,n,t){e.exports=t.p+"static/pr-7008-12e796a08a1745838305740da6a80cef.png"},432:function(e,n,t){"use strict";t.r(n),n.default='require "ecr"\n\nclass Foo\n  getter title\n\n  def initialize(@title : String)\n  end\n\n  ECR.def_to_s "#{__DIR__}/foo.ecr"\nend\n\nputs Foo.new("hello world").to_s\n'},433:function(e,n,t){"use strict";t.r(n),n.default="<html>\n  <head>\n    <title><%= title %></title>\n  </head>\n  <body>\n    <h1><%= tilte %></h1>\n  </body>\n</html>\n"},434:function(e,n,t){"use strict";t.r(n),n.default="Error in foo.cr:12: instantiating 'Foo#to_s()'\n\nputs Foo.new(\"hello world\").to_s\n                            ^~~~\n\nin .../src/object.cr:95: instantiating 'String.class#build()'\n\n    String.build do |io|\n           ^~~~~\n\nin .../src/string.cr:268: instantiating 'String::Builder.class#build(Int32)'\n\n    String::Builder.build(capacity) do |builder|\n                    ^~~~~\n\nin .../src/string.cr:268: instantiating 'String::Builder.class#build(Int32)'\n\n    String::Builder.build(capacity) do |builder|\n                    ^~~~~\n\nin .../src/object.cr:95: instantiating 'String.class#build()'\n\n    String.build do |io|\n           ^~~~~\n\nin .../src/object.cr:96: instantiating 'to_s(String::Builder)'\n\n      to_s io\n      ^~~~\n\nin foo.ecr:6: undefined local variable or method 'tilte'\n\n    <h1><%= tilte %></h1>\n            ^~~~~\n"},435:function(e,n,t){"use strict";t.r(n),n.default='___io___ << "<html>\\n  <head>\\n    <title>"\n(title).to_s ___io___\n___io___ << "</title>\\n  </head>\\n  <body>\\n    <h1>"\n(tilte).to_s ___io___\n___io___ << "</h1>\\n  </body>\\n</html>\\n"\n'},436:function(e,n,t){"use strict";t.r(n),n.default="macro new(node)\n  {{node}}.new\nend\n\nnew BadType\n"},437:function(e,n,t){"use strict";t.r(n),n.default="Error in new.cr:5: expanding macro\n\nnew BadType\n^~~\n\nin new.cr:5: expanding macro\n\nnew BadType\n^\n\nin macro 'new' new.cr:1, line 1:\n\n>  1.   BadType.new\n\nundefined constant BadType\n"},438:function(e,n,t){"use strict";t.r(n),n.default="macro new(node)\n  #<loc:{{node.filename}},{{node.line_number}},{{node.column_number}}>{{node}}.new\nend\n\nnew BadType\n"},439:function(e,n,t){"use strict";t.r(n),n.default="Error in new.cr:5: expanding macro\n\nnew BadType\n^~~\n\nin new.cr:5: undefined constant BadType\n\nnew BadType\n    ^~~~~~~\n"}}]);
//# sourceMappingURL=component---cache-mdx-deck-template-d-2-d-1-f-177-e-1-f-9-fbd-41-b-013-e-5-a-00-e-9592-a-js-ae9889c1543f4ad9487b.js.map