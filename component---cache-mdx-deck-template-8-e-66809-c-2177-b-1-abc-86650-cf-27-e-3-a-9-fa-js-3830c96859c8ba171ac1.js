(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{179:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),o=t(186),c=(t(28),t(20),t(11),t(46),t(37),t(21),t(194)),m=t(440),l=t(258),s=t(203),i=t.n(s),p=t(447),u=t.n(p),f=t(448),d=t.n(f);function g(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}var _=Object.assign({},i.a),E=(new Date("2018-11-17T00:00:00.000Z"),[function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"h2",components:n},r.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"crystal tool format"),"の話"))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement("img",{src:d.a}),r.a.createElement(c.MDXTag,{name:"ul",components:n},r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"Twitter: @make_now_just"),r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"GitHub: @MakeNowJust"),r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"正規表現好き")))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"h2",components:n},"No.4 Crystal Contributor"),r.a.createElement("img",{src:u.a}))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"h2",components:n},"Crystal とは？"),r.a.createElement(c.MDXTag,{name:"p",components:n},r.a.createElement(c.MDXTag,{name:"strong",components:n,parentName:"p"},"Ruby っぽい構文"),"と",r.a.createElement(c.MDXTag,{name:"strong",components:n,parentName:"p"},"C 言語の速度"),"を兼ね備えた\nプログラミング言語。"),r.a.createElement(c.MDXTag,{name:"p",components:n},"LLVM でネイティブコードにコンパイルする。"))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"pre",components:n},r.a.createElement(c.MDXTag,{name:"code",components:n,parentName:"pre",props:{className:"language-crystal",metaString:""}},'a = 1\n\nwhile true\n  case a\n  when Int32  then a = "foo"\n  when String then break\n  end\nend\n\ntypeof(a) # => String\n')))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"p",components:n},"😎 ",r.a.createElement(c.MDXTag,{name:"a",components:n,parentName:"p",props:{href:"https://crystal-lang.org/"}},"https://crystal-lang.org/")))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"h2",components:n},r.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"crystal"),"コマンド色々"),r.a.createElement(c.MDXTag,{name:"ul",components:n},r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},r.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"crystal run foo.cr"),": コンパイル → 実行"),r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},r.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"crystal build foo.cr"),": コンパイル")))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"h2",components:n},r.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"crystal"),"コマンド色々"),r.a.createElement(c.MDXTag,{name:"ul",components:n},r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},r.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"crystal docs"),": ドキュメントジェネレータ"),r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},r.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"crystal play"),": プレイグランド"),r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},r.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"crystal tool format"),": フォーマッター")))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"p",components:n},"今回は",r.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"crystal tool format"),"の話"))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"h2",components:n},r.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"crystal tool format")),r.a.createElement(c.MDXTag,{name:"ul",components:n},r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"Crystal 公式のフォーマッター"),r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"コンパイラのソースコードなどは\nこれでフォーマットされている")))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"h2",components:n},r.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"crystal tool format")),r.a.createElement(c.MDXTag,{name:"ul",components:n},r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"インデント・末尾のコンマなどを修正"),r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"元のコードを",r.a.createElement(c.MDXTag,{name:"strong",components:n,parentName:"li"},"可能な限り"),"尊重する")))},function(e){var n=e.components,t=g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",Layout:m.Split,layoutProps:t,components:n},r.a.createElement(c.MDXTag,{name:"pre",components:n},r.a.createElement(c.MDXTag,{name:"code",components:n,parentName:"pre",props:{className:"language-crystal",metaString:""}},'[{foo: "foo"}, {foo: "bar"},\n {foo: "baz"}]\n')),r.a.createElement(c.MDXTag,{name:"pre",components:n},r.a.createElement(c.MDXTag,{name:"code",components:n,parentName:"pre",props:{className:"language-crystal",metaString:""}},'[\n  {\n    foo: "foo",\n  },\n  {foo: "bar"},\n  {\n    foo: "baz",\n  },\n]\n')))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"h2",components:n},r.a.createElement(c.MDXTag,{name:"strong",components:n,parentName:"h2"},"普通"),"のフォーマッタの実装方法"),r.a.createElement(c.MDXTag,{name:"ol",components:n},r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ol"},"ソースコードを構文解析\n(このときに位置情報を付加する)"),r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ol"},"抽象構文木を辿りながら\nフォーマットしたソースコードを生成する")))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"p",components:n},"Crystal のような書き方が複数ある言語で、\n構文木に全ての情報を付加するのは大変。\n(e.g. メソッド呼び出しの括弧の有無、\n文字列リテラルの区切り文字)"),r.a.createElement(c.MDXTag,{name:"p",components:n},"そうでなくとも前述したことをするには\n位置情報を確認することが多くなって煩雑。"))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"h2",components:n},r.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"crystal tool format"),"での方法"),r.a.createElement(c.MDXTag,{name:"ol",components:n},r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ol"},"ソースコードを構文解析"),r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ol"},"字句解析器をもう一度作る"),r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ol"},"抽象構文木を辿りながら、\n字句解析器を動かしつつ、\nフォーマットしたソースコードを生成する")))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"p",components:n},"ちなみに実装は、Crystal のリポジトリの、"),r.a.createElement(c.MDXTag,{name:"p",components:n},r.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"src/compiler/crystal/tools/formatter.cr")),r.a.createElement(c.MDXTag,{name:"p",components:n},"にあります。"))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"p",components:n},"驚きの 1 ファイル 4861 行。"))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.CodeSurfer,{title:"e.g. 配列のフォーマット",code:t(449).default,lang:"ruby",showNumbers:!0,dark:!0,steps:[{notes:"def format_literal_elements"},{lines:[3],notes:"最初の`[`の出力"},{lines:new Array(18).join().split(",").map(function(e,n){return n+11}),notes:"`[`のあとに改行が続けば内側のインデントを2に、そうじゃない場合はそのまま"},{lines:new Array(47).join().split(",").map(function(e,n){return n+29}),notes:"各要素をフォーマットしていく"},{lines:new Array(5).join().split(",").map(function(e,n){return n+41}),notes:"要素をインデントと共にフォーマットする"},{lines:new Array(26).join().split(",").map(function(e,n){return n+49}),notes:"要素のあとに続くはずのコンマについての処理"}]}))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"h2",components:n},"この方法の問題点"),r.a.createElement(c.MDXTag,{name:"ul",components:n},r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"ソースコードに合わせて字句解析器を動かすので、\n実質的に構文解析器の再実装になる"),r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"e.g. 字句解析器の",r.a.createElement(c.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"next_token"),"を一つ忘れると\n結果が大きくずれてよく分からなくなる")))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"h2",components:n},"この方法の問題点"),r.a.createElement(c.MDXTag,{name:"ul",components:n},r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"なので、とてもバグを作りやすい"),r.a.createElement(c.MDXTag,{name:"li",components:n,parentName:"ul"},"とてもバグを作りやすい")),r.a.createElement(c.MDXTag,{name:"p",components:n},"大事なことなので"))},function(e){var n=e.components;g(e,["components"]);return r.a.createElement(c.MDXTag,{name:"wrapper",components:n},r.a.createElement(c.MDXTag,{name:"p",components:n},"他のフォーマッターの実装について書こうとして力尽きた。"))}]);t.d(n,"query",function(){return w});n.default=function(e){var n=e.data;return r.a.createElement(o.a,{data:n,slides:E,theme:_})};var w="2617449398"},186:function(e,n,t){"use strict";t(28),t(20),t(11);var a=t(191),r=t(15),o=t.n(r),c=t(0),m=t.n(c),l=t(193),s=t(200);t(196);Object(s.setConfig)({ignoreSFC:!0,pureRender:!0});var i=a.updaters.previous,p=a.updaters.next,u=a.updaters.decrementIndex,f=a.updaters.incrementIndex,d=a.updaters.decrementStep,g=a.updaters.incrementStep,_=a.updaters.toggleMode,E=a.constants.keys,w=m.a.memo(function(e){var n=e.data,t=e.slides,r=e.theme,o=m.a.createRef(),s=m.a.createRef();Object(c.useEffect)(function(){s.current.focus()});var w=n.site.siteMetadata.title,h=n.file.fields.frontmatter.title+" - "+w;return m.a.createElement(m.a.Fragment,null,m.a.createElement(l.Helmet,null,m.a.createElement("title",null,h),m.a.createElement("meta",{name:"viewport",content:""})),m.a.createElement("div",{ref:s,role:"presentation",tabIndex:"-1",onKeyDown:function(e){if(document.activeElement===s.current&&!e.metaKey&&!e.ctrlKey){var n=o.current,t=e.altKey&&!e.shiftKey,a=e.shiftKey&&!e.altKey;if(t)switch(e.keyCode){case E.p:n.update(_("presenter"));break;case E.o:n.update(_("overview"));break;case E.g:n.update(_("grid"))}else if(a)switch(e.keyCode){case E.right:case E.pageDown:e.preventDefault(),n.update(f);break;case E.left:case E.pageUp:e.preventDefault(),n.update(u)}else if(!t&&!a)switch(e.keyCode){case E.right:case E.pageDown:case E.space:e.preventDefault(),n.update(p);break;case E.left:case E.pageUp:e.preventDefault(),n.update(i);break;case E.up:n.update(d);break;case E.down:n.update(g)}}}},m.a.createElement(a.SlideDeck,{ref:o,slides:t,theme:r})))});w.propTypes={data:o.a.object.isRequired,slides:o.a.array.isRequired,theme:o.a.object.isRequired},n.a=w},440:function(e,n,t){e.exports=t(441)},441:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Invert",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"Split",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"SplitRight",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(n,"FullScreenCode",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(n,"Horizontal",{enumerable:!0,get:function(){return m.default}});var a=l(t(442)),r=l(t(443)),o=l(t(444)),c=l(t(445)),m=l(t(446));function l(e){return e&&e.__esModule?e:{default:e}}},442:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=c(t(0)),r=c(t(183)),o=t(188);function c(e){return e&&e.__esModule?e:{default:e}}var m=r.default.div.withConfig({displayName:"Invert",componentId:"sc-1sax20x-0"})({width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center","& a":{color:"inherit"}},o.color);m.defaultProps={color:"background",bg:"text"};n.default=function(e){return a.default.createElement(m,e)}},443:function(e,n,t){"use strict";function a(){var e=function(e,n){n||(n=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}(["",""]);return a=function(){return e},e}t(58),t(192),t(82),t(11),t(36),t(29),t(28),t(187),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(t(183)),o=l(t(0)),c=l(t(189)),m=l(t(190));function l(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i=r.default.div.withConfig({displayName:"Split__Root",componentId:"sc-12ot84a-0"})([],{width:"100vw",height:"100vh"}),p=function(e){var n=e.children,t=s(o.default.Children.toArray(n.props.children)),a=t[0],r=t.slice(1);return o.default.createElement(i,null,o.default.createElement(u,{_css:{alignItems:"center",height:"100%"}},o.default.createElement(m.default,{width:.5},a),o.default.createElement(m.default,{width:.5},r)))};n.default=p;var u=(0,r.default)(c.default)(a(),function(e){return e._css})},444:function(e,n,t){"use strict";function a(){var e=function(e,n){n||(n=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}(["",""]);return a=function(){return e},e}t(58),t(192),t(82),t(11),t(36),t(29),t(28),t(187),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(t(183)),o=l(t(0)),c=l(t(189)),m=l(t(190));function l(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i=r.default.div.withConfig({displayName:"SplitRight__Root",componentId:"h1017v-0"})([],{width:"100vw",height:"100vh"}),p=function(e){var n=e.children,t=s(o.default.Children.toArray(n.props.children)),a=t[0],r=t.slice(1);return o.default.createElement(i,null,o.default.createElement(u,{_css:{alignItems:"center",height:"100%"}},o.default.createElement(m.default,{width:.5},r),o.default.createElement(m.default,{width:.5},a)))};n.default=p;var u=(0,r.default)(c.default)(a(),function(e){return e._css})},445:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(t(0));function r(e){return e&&e.__esModule?e:{default:e}}var o=r(t(183)).default.div.withConfig({displayName:"FullScreenCode__FullCode",componentId:"jtwdz6-0"})({width:"100vw",height:"100vh",textAlign:"left","& pre":{margin:"0 !important",width:"100vw",height:"100vh",overflow:"auto"}});n.default=function(e){return a.default.createElement(o,e)}},446:function(e,n,t){"use strict";function a(){var e=function(e,n){n||(n=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}(["",""]);return a=function(){return e},e}t(187),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(t(183)),o=l(t(0)),c=l(t(189)),m=l(t(190));function l(e){return e&&e.__esModule?e:{default:e}}var s=r.default.div.withConfig({displayName:"Horizontal__Root",componentId:"sc-8t6998-0"})([],{width:"100vw",height:"100vh"}),i=function(e){var n=e.children,t=o.default.Children.toArray(n.props.children),a=t.length;return o.default.createElement(s,null,o.default.createElement(p,{_css:{alignItems:"center",height:"100%"}},t.map(function(e){return o.default.createElement(m.default,{key:e.key,width:1/a},e)})))};n.default=i;var p=(0,r.default)(c.default)(a(),function(e){return e._css})},447:function(e,n,t){e.exports=t.p+"static/no4-6a38b65f179c50ee4e0c37a3360e67ee.png"},448:function(e,n,t){e.exports=t.p+"static/icon-88257879c967f53168ad46e40c780cb2.png"},449:function(e,n,t){"use strict";t.r(n),n.default='def format_literal_elements(elements, prefix, suffix)\n  slash_is_regex!\n  write_token prefix\n  has_newlines = false\n  wrote_newline = false\n  write_space_at_end = false\n  next_needs_indent = false\n  found_comment = false\n  found_first_newline = false\n  found_comment = skip_space\n  if found_comment || @token.type == :NEWLINE\n    # add one level of indentation for contents if a newline is present\n    offset = @indent + 2\n    if elements.empty?\n      skip_space_or_newline\n      write_token suffix\n      return false\n    end\n    indent(offset) { consume_newlines }\n    skip_space_or_newline\n    wrote_newline = true\n    next_needs_indent = true\n    has_newlines = true\n    found_first_newline = true\n  else\n    # indent contents at the same column as starting token if no newline\n    offset = @column\n  end\n  elements.each_with_index do |element, i|\n    current_element = element\n    if current_element.is_a?(HashLiteral::Entry)\n      current_element = current_element.key\n    end\n    # This is to prevent writing `{{` and `{%`\n    if prefix == :"{" && i == 0 && !wrote_newline &&\n       (@token.type == :"{" || @token.type == :"{{" || @token.type == :"{%" ||\n       @token.type == :"%" || @token.raw.starts_with?("%"))\n      write " "\n      write_space_at_end = true\n    end\n    if next_needs_indent\n      write_indent(offset, element)\n    else\n      indent(offset, element)\n    end\n    has_heredoc_in_line = !@lexer.heredocs.empty?\n    last = last?(i, elements)\n    found_comment = skip_space(offset, write_comma: (last || has_heredoc_in_line) && has_newlines)\n    if @token.type == :","\n      if !found_comment && (!last || has_heredoc_in_line)\n        write ","\n        wrote_comma = true\n      end\n      slash_is_regex!\n      next_token\n      found_comment = skip_space(offset, write_comma: last && has_newlines)\n      if @token.type == :NEWLINE\n        if last && !found_comment && !wrote_comma\n          write ","\n          found_comment = true\n        end\n        indent(offset) { consume_newlines }\n        skip_space_or_newline\n        next_needs_indent = true\n        has_newlines = true\n      else\n        if !last && !found_comment\n          write " "\n          next_needs_indent = false\n        elsif found_comment\n          next_needs_indent = true\n        end\n      end\n    end\n  end\n  finish_list suffix, has_newlines, found_comment, found_first_newline, write_space_at_end\nend'}}]);
//# sourceMappingURL=component---cache-mdx-deck-template-8-e-66809-c-2177-b-1-abc-86650-cf-27-e-3-a-9-fa-js-3830c96859c8ba171ac1.js.map