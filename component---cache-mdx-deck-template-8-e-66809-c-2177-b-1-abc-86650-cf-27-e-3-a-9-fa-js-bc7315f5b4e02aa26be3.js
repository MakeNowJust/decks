(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{140:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),o=t(148),m=(t(75),t(161)),c=t.n(m),l=(t(32),t(155)),s=t(369),p=t(196),i=t(172),u=t.n(i),f=t(376),d=t.n(f),g=t(377),E=t.n(g),_=Object.assign({},u.a),M=(new Date("2018-11-17T00:00:00.000Z"),[function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"h2",components:n},r.a.createElement(l.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"crystal tool format"),"の話"))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement("img",{src:E.a}),r.a.createElement(l.MDXTag,{name:"ul",components:n},r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ul"},"Twitter: @make_now_just"),r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ul"},"GitHub: @MakeNowJust"),r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ul"},"正規表現好き")))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"h2",components:n},"No.4 Crystal Contributor"),r.a.createElement("img",{src:d.a}))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"h2",components:n},"Crystal とは？"),r.a.createElement(l.MDXTag,{name:"p",components:n},r.a.createElement(l.MDXTag,{name:"strong",components:n,parentName:"p"},"Ruby っぽい構文"),"と",r.a.createElement(l.MDXTag,{name:"strong",components:n,parentName:"p"},"C 言語の速度"),"を兼ね備えた\nプログラミング言語。"),r.a.createElement(l.MDXTag,{name:"p",components:n},"LLVM でネイティブコードにコンパイルする。"))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"pre",components:n},r.a.createElement(l.MDXTag,{name:"code",components:n,parentName:"pre",props:{className:"language-crystal",metaString:""}},'a = 1\n\nwhile true\n  case a\n  when Int32  then a = "foo"\n  when String then break\n  end\nend\n\ntypeof(a) # => String\n')))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"p",components:n},"😎 ",r.a.createElement(l.MDXTag,{name:"a",components:n,parentName:"p",props:{href:"https://crystal-lang.org/"}},"https://crystal-lang.org/")))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"h2",components:n},r.a.createElement(l.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"crystal"),"コマンド色々"),r.a.createElement(l.MDXTag,{name:"ul",components:n},r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ul"},r.a.createElement(l.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"crystal run foo.cr"),": コンパイル → 実行"),r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ul"},r.a.createElement(l.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"crystal build foo.cr"),": コンパイル")))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"h2",components:n},r.a.createElement(l.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"crystal"),"コマンド色々"),r.a.createElement(l.MDXTag,{name:"ul",components:n},r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ul"},r.a.createElement(l.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"crystal docs"),": ドキュメントジェネレータ"),r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ul"},r.a.createElement(l.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"crystal play"),": プレイグランド"),r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ul"},r.a.createElement(l.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"crystal tool format"),": フォーマッター")))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"p",components:n},"今回は",r.a.createElement(l.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"crystal tool format"),"の話"))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"h2",components:n},r.a.createElement(l.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"crystal tool format")),r.a.createElement(l.MDXTag,{name:"ul",components:n},r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ul"},"Crystal 公式のフォーマッター"),r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ul"},"コンパイラのソースコードなどは\nこれでフォーマットされている")))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"h2",components:n},r.a.createElement(l.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"crystal tool format")),r.a.createElement(l.MDXTag,{name:"ul",components:n},r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ul"},"インデント・末尾のコンマなどを修正"),r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ul"},"元のコードを",r.a.createElement(l.MDXTag,{name:"strong",components:n,parentName:"li"},"可能な限り"),"尊重する")))},function(e){var n=e.components,t=c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",Layout:s.Split,layoutProps:t,components:n},r.a.createElement(l.MDXTag,{name:"pre",components:n},r.a.createElement(l.MDXTag,{name:"code",components:n,parentName:"pre",props:{className:"language-crystal",metaString:""}},'[{foo: "foo"}, {foo: "bar"},\n {foo: "baz"}]\n')),r.a.createElement(l.MDXTag,{name:"pre",components:n},r.a.createElement(l.MDXTag,{name:"code",components:n,parentName:"pre",props:{className:"language-crystal",metaString:""}},'[\n  {\n    foo: "foo",\n  },\n  {foo: "bar"},\n  {\n    foo: "baz",\n  },\n]\n')))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"h2",components:n},r.a.createElement(l.MDXTag,{name:"strong",components:n,parentName:"h2"},"普通"),"のフォーマッタの実装方法"),r.a.createElement(l.MDXTag,{name:"ol",components:n},r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ol"},"ソースコードを構文解析\n(このときに位置情報を付加する)"),r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ol"},"抽象構文木を辿りながら\nフォーマットしたソースコードを生成する")))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"p",components:n},"Crystal のような書き方が複数ある言語で、\n構文木に全ての情報を付加するのは大変。\n(e.g. メソッド呼び出しの括弧の有無、\n文字列リテラルの区切り文字)"),r.a.createElement(l.MDXTag,{name:"p",components:n},"そうでなくとも前述したことをするには\n位置情報を確認することが多くなって煩雑。"))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"h2",components:n},r.a.createElement(l.MDXTag,{name:"inlineCode",components:n,parentName:"h2"},"crystal tool format"),"での方法"),r.a.createElement(l.MDXTag,{name:"ol",components:n},r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ol"},"ソースコードを構文解析"),r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ol"},"字句解析器をもう一度作る"),r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ol"},"抽象構文木を辿りながら、\n字句解析器を動かしつつ、\nフォーマットしたソースコードを生成する")))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"p",components:n},"ちなみに実装は、Crystal のリポジトリの、"),r.a.createElement(l.MDXTag,{name:"p",components:n},r.a.createElement(l.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"src/compiler/crystal/tools/formatter.cr")),r.a.createElement(l.MDXTag,{name:"p",components:n},"にあります。"))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"p",components:n},"驚きの 1 ファイル 4861 行。"))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(p.CodeSurfer,{title:"e.g. 配列のフォーマット",code:t(378),lang:"ruby",showNumbers:!0,dark:!0,steps:[{notes:"def format_literal_elements"},{lines:[3],notes:"最初の`[`の出力"},{lines:new Array(18).join().split(",").map(function(e,n){return n+11}),notes:"`[`のあとに改行が続けば内側のインデントを2に、そうじゃない場合はそのまま"},{lines:new Array(47).join().split(",").map(function(e,n){return n+29}),notes:"各要素をフォーマットしていく"},{lines:new Array(5).join().split(",").map(function(e,n){return n+41}),notes:"要素をインデントと共にフォーマットする"},{lines:new Array(26).join().split(",").map(function(e,n){return n+49}),notes:"要素のあとに続くはずのコンマについての処理"}]}))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"h2",components:n},"この方法の問題点"),r.a.createElement(l.MDXTag,{name:"ul",components:n},r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ul"},"ソースコードに合わせて字句解析器を動かすので、\n実質的に構文解析器の再実装になる"),r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ul"},"e.g. 字句解析器の",r.a.createElement(l.MDXTag,{name:"inlineCode",components:n,parentName:"li"},"next_token"),"を一つ忘れると\n結果が大きくずれてよく分からなくなる")))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"h2",components:n},"この方法の問題点"),r.a.createElement(l.MDXTag,{name:"ul",components:n},r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ul"},"なので、とてもバグを作りやすい"),r.a.createElement(l.MDXTag,{name:"li",components:n,parentName:"ul"},"とてもバグを作りやすい")),r.a.createElement(l.MDXTag,{name:"p",components:n},"大事なことなので"))},function(e){var n=e.components;c()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:n},r.a.createElement(l.MDXTag,{name:"p",components:n},"他のフォーマッターの実装について書こうとして力尽きた。"))}]);t.d(n,"query",function(){return h});n.default=function(e){var n=e.data;return r.a.createElement(o.a,{data:n,slides:M,theme:_})};var h="2617449398"},148:function(e,n,t){"use strict";t(74),t(52);var a=t(149),r=t(4),o=t.n(r),m=t(0),c=t.n(m),l=t(152),s=(t(160),a.updaters.previous),p=a.updaters.next,i=a.updaters.decrementIndex,u=a.updaters.incrementIndex,f=a.updaters.decrementStep,d=a.updaters.incrementStep,g=a.updaters.toggleMode,E=a.constants.keys,_=c.a.memo(function(e){var n=e.data,t=e.slides,r=e.theme,o=c.a.createRef(),_=c.a.createRef();Object(m.useEffect)(function(){_.current.focus()});var M=n.site.siteMetadata.title,h=n.file.fields.frontmatter.title+" - "+M;return c.a.createElement(c.a.Fragment,null,c.a.createElement(l.Helmet,null,c.a.createElement("title",null,h),c.a.createElement("meta",{name:"viewport",content:""})),c.a.createElement("div",{ref:_,role:"presentation",tabIndex:"-1",onKeyDown:function(e){if(document.activeElement===_.current&&!e.metaKey&&!e.ctrlKey){var n=o.current,t=e.altKey&&!e.shiftKey,a=e.shiftKey&&!e.altKey;if(t)switch(e.keyCode){case E.p:n.update(g("presenter"));break;case E.o:n.update(g("overview"));break;case E.g:n.update(g("grid"))}else if(a)switch(e.keyCode){case E.right:case E.pageDown:e.preventDefault(),n.update(u);break;case E.left:case E.pageUp:e.preventDefault(),n.update(i)}else if(!t&&!a)switch(e.keyCode){case E.right:case E.pageDown:case E.space:e.preventDefault(),n.update(p);break;case E.left:case E.pageUp:e.preventDefault(),n.update(s);break;case E.up:n.update(f);break;case E.down:n.update(d)}}}},c.a.createElement(a.SlideDeck,{ref:o,slides:t,theme:r})))});_.propTypes={data:o.a.object.isRequired,slides:o.a.array.isRequired,theme:o.a.object.isRequired},n.a=_},369:function(e,n,t){e.exports=t(370)},370:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t(371);Object.defineProperty(n,"Invert",{enumerable:!0,get:function(){return l(a).default}});var r=t(372);Object.defineProperty(n,"Split",{enumerable:!0,get:function(){return l(r).default}});var o=t(373);Object.defineProperty(n,"SplitRight",{enumerable:!0,get:function(){return l(o).default}});var m=t(374);Object.defineProperty(n,"FullScreenCode",{enumerable:!0,get:function(){return l(m).default}});var c=t(375);function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"Horizontal",{enumerable:!0,get:function(){return l(c).default}})},371:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a,r=t(141),o=(a=r)&&a.__esModule?a:{default:a},m=t(143);var c=o.default.div([],{width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center","& a":{color:"inherit"}},m.color);c.defaultProps={color:"background",bg:"text"},n.default=c},372:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=c(t(0)),r=c(t(141)),o=c(t(144)),m=c(t(145));function c(e){return e&&e.__esModule?e:{default:e}}var l=r.default.div([],{width:"100vw",height:"100vh"});n.default=function(e){var n,t=e.children,r=a.default.Children.toArray(t.props.children),c=(n=r,Array.isArray(n)?n:Array.from(n)),s=c[0],p=c.slice(1);return a.default.createElement(l,null,a.default.createElement(o.default,{css:{alignItems:"center",height:"100%"}},a.default.createElement(m.default,{width:.5},s),a.default.createElement(m.default,{width:.5},p)))}},373:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=c(t(0)),r=c(t(141)),o=c(t(144)),m=c(t(145));function c(e){return e&&e.__esModule?e:{default:e}}var l=r.default.div([],{width:"100vw",height:"100vh"});n.default=function(e){var n,t=e.children,r=a.default.Children.toArray(t.props.children),c=(n=r,Array.isArray(n)?n:Array.from(n)),s=c[0],p=c.slice(1);return a.default.createElement(l,null,a.default.createElement(o.default,{css:{alignItems:"center",height:"100%"}},a.default.createElement(m.default,{width:.5},p),a.default.createElement(m.default,{width:.5},s)))}},374:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});a(t(0));function a(e){return e&&e.__esModule?e:{default:e}}var r=a(t(141)).default.div([],{width:"100vw",height:"100vh",textAlign:"left","& pre":{margin:"0 !important",width:"100vw",height:"100vh",overflow:"auto"}});n.default=r},375:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=c(t(0)),r=c(t(141)),o=c(t(144)),m=c(t(145));function c(e){return e&&e.__esModule?e:{default:e}}var l=r.default.div([],{width:"100vw",height:"100vh"});n.default=function(e){var n=e.children,t=a.default.Children.toArray(n.props.children),r=t.length;return a.default.createElement(l,null,a.default.createElement(o.default,{css:{alignItems:"center",height:"100%"}},t.map(function(e){return a.default.createElement(m.default,{key:e.key,width:1/r},e)})))}},376:function(e,n,t){e.exports=t.p+"static/no4-6a38b65f179c50ee4e0c37a3360e67ee.png"},377:function(e,n,t){e.exports=t.p+"static/icon-88257879c967f53168ad46e40c780cb2.png"},378:function(e,n){e.exports='def format_literal_elements(elements, prefix, suffix)\n  slash_is_regex!\n  write_token prefix\n  has_newlines = false\n  wrote_newline = false\n  write_space_at_end = false\n  next_needs_indent = false\n  found_comment = false\n  found_first_newline = false\n  found_comment = skip_space\n  if found_comment || @token.type == :NEWLINE\n    # add one level of indentation for contents if a newline is present\n    offset = @indent + 2\n    if elements.empty?\n      skip_space_or_newline\n      write_token suffix\n      return false\n    end\n    indent(offset) { consume_newlines }\n    skip_space_or_newline\n    wrote_newline = true\n    next_needs_indent = true\n    has_newlines = true\n    found_first_newline = true\n  else\n    # indent contents at the same column as starting token if no newline\n    offset = @column\n  end\n  elements.each_with_index do |element, i|\n    current_element = element\n    if current_element.is_a?(HashLiteral::Entry)\n      current_element = current_element.key\n    end\n    # This is to prevent writing `{{` and `{%`\n    if prefix == :"{" && i == 0 && !wrote_newline &&\n       (@token.type == :"{" || @token.type == :"{{" || @token.type == :"{%" ||\n       @token.type == :"%" || @token.raw.starts_with?("%"))\n      write " "\n      write_space_at_end = true\n    end\n    if next_needs_indent\n      write_indent(offset, element)\n    else\n      indent(offset, element)\n    end\n    has_heredoc_in_line = !@lexer.heredocs.empty?\n    last = last?(i, elements)\n    found_comment = skip_space(offset, write_comma: (last || has_heredoc_in_line) && has_newlines)\n    if @token.type == :","\n      if !found_comment && (!last || has_heredoc_in_line)\n        write ","\n        wrote_comma = true\n      end\n      slash_is_regex!\n      next_token\n      found_comment = skip_space(offset, write_comma: last && has_newlines)\n      if @token.type == :NEWLINE\n        if last && !found_comment && !wrote_comma\n          write ","\n          found_comment = true\n        end\n        indent(offset) { consume_newlines }\n        skip_space_or_newline\n        next_needs_indent = true\n        has_newlines = true\n      else\n        if !last && !found_comment\n          write " "\n          next_needs_indent = false\n        elsif found_comment\n          next_needs_indent = true\n        end\n      end\n    end\n  end\n  finish_list suffix, has_newlines, found_comment, found_first_newline, write_space_at_end\nend'}}]);
//# sourceMappingURL=component---cache-mdx-deck-template-8-e-66809-c-2177-b-1-abc-86650-cf-27-e-3-a-9-fa-js-bc7315f5b4e02aa26be3.js.map